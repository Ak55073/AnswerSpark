// Download this file
https://repo1.maven.org/maven2/com/crealytics/spark-excel_2.12/3.5.1_0.20.4/spark-excel_2.12-3.5.1_0.20.4.jar

// [RUN CMD AS ADMIN] and Start Spark-shell with following
spark-shell --jars "C:\Users\abhinav.kumar62\Downloads\spark-excel_2.12-3.5.1_0.20.4.jar"

-------------
USE :paste for below
-------------

val customerRAWDF = spark.read
	.format("com.crealytics.spark.excel")
	.option("header", "true")
	.option("inferSchema", "true")
	.load("C:/Users/abhinav.kumar62/Downloads/CapstoneProject_FA3_1/Spark Dataset/Customer Purchase History.xlsx")
	.toDF()

// OPTIONAL: TO REMOVE SPACES IN HEADER
val customerDF = customerRAWDF
	.withColumnRenamed("Customer ID", "CustomerID")
	.withColumnRenamed("Purchase Date", "PurchaseDate")
	.withColumnRenamed("Product ID", "ProductID")
	.withColumnRenamed("Discount Applied", "DiscountApplied")

customerDF.createTempView("customers");
	  
val customerRDD = customerDF.rdd
 
-------------
  
val productRAWDF = spark.read
	.format("com.crealytics.spark.excel")
	.option("header", "true")
	.option("inferSchema", "true")
	.load("C:/Users/abhinav.kumar62/Downloads/CapstoneProject_FA3_1/Spark Dataset/Product Catalog.xlsx")
	.toDF()

// OPTIONAL: TO REMOVE SPACES IN HEADER
val productDF = productRAWDF
	.withColumnRenamed("Product ID", "ProductID")
	.withColumnRenamed("Product Name", "ProductName")
	.withColumnRenamed("Product Category", "ProductCategory")
	.withColumnRenamed("Discount Applied", "DiscountApplied")
	
productDF.createTempView("products");
	
val productRDD = productDF.rdd
 
-------------
  
val trafficDF = spark.read
	.option("header","true")
	.option("inferSchema","true")
	.csv("C:/Users/abhinav.kumar62/Downloads/CapstoneProject_FA3_1/Spark Dataset/Website traffic and user behavior.csv")
	.toDF()
	
trafficDF.createTempView("traffics");

val trafficRDD = trafficDF.rdd

-------------

customerDF.printSchema

productDF.printSchema

trafficDF.printSchema

-------------
